% Run RBC parallel

% params
delta_val = 1e-4;
V0 = 0.02;
k_c = 0.1; 
k_a = 0.5;
k_v = 0.2; 
k_r = 0.0;
t = 1500;
rng(46);

% num rbc
n = 4;

u=ComUnit('erg',ComUnit.nm_to_cm(1000),300,ComUnit.kBT_to_erg(10,300)); 

RBCs = cell(n,1);

for i = 1:n
    RBCs{i} = RBC(ModMembrane(2,'unit',u));
end

parfor i = 1:n
    RBCs{i} = computeRBC(RBCs{i}, V0, k_c, k_a, k_v, k_r, t, delta_val, false, false);
end

%% Plot 4 results
fig=figure;
subplot(2,2,1);
plot(RBCs{i}.m,'f',fig, 'col', H_before, 'col_min', 0, 'col_max', max(H_before), 'colBar', true);
title("Before Langevin Propagation on F internal")
subplot(2,2,2);
plot(m,'f',fig);
plot(m,'f',fig, 'col', H_after, 'col_min', 0, 'col_max', max(H_after), 'colBar', true);
title("After Langevin Propagation on F internal")